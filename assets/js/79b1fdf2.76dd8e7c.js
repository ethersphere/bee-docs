"use strict";(self.webpackChunkbee_docs=self.webpackChunkbee_docs||[]).push([[1202],{11470(e,n,t){t.d(n,{A:()=>k});var s=t(96540),r=t(34164),a=t(17559),i=t(23104),o=t(56347),l=t(205),d=t(57485),c=t(31682),h=t(70679);function f(e){var n,t;return null!=(n=null==(t=s.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')}))?void 0:t.filter(Boolean))?n:[]}function p(e){const{values:n,children:t}=e;return(0,s.useMemo)(()=>{const e=null!=n?n:function(e){return f(e).map(e=>{let{props:{value:n,label:t,attributes:s,default:r}}=e;return{value:n,label:t,attributes:s,default:r}})}(t);return function(e){const n=(0,c.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map(e=>e.value).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e},[n,t])}function x(e){let{value:n,tabValues:t}=e;return t.some(e=>e.value===n)}function u(e){let{queryString:n=!1,groupId:t}=e;const r=(0,o.W6)(),a=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=t?t:null}({queryString:n,groupId:t});return[(0,d.aZ)(a),(0,s.useCallback)(e=>{if(!a)return;const n=new URLSearchParams(r.location.search);n.set(a,e),r.replace(Object.assign({},r.location,{search:n.toString()}))},[a,r])]}function m(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,a=p(e),[i,o]=(0,s.useState)(()=>function(e){var n;let{defaultValue:t,tabValues:s}=e;if(0===s.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!x({value:t,tabValues:s}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+s.map(e=>e.value).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}const r=null!=(n=s.find(e=>e.default))?n:s[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:a})),[d,c]=u({queryString:t,groupId:r}),[f,m]=function(e){let{groupId:n}=e;const t=function(e){return e?"docusaurus.tab."+e:null}(n),[r,a]=(0,h.Dv)(t);return[r,(0,s.useCallback)(e=>{t&&a.set(e)},[t,a])]}({groupId:r}),j=(()=>{const e=null!=d?d:f;return x({value:e,tabValues:a})?e:null})();(0,l.A)(()=>{j&&o(j)},[j]);return{selectedValue:i,selectValue:(0,s.useCallback)(e=>{if(!x({value:e,tabValues:a}))throw new Error("Can't select invalid tab value="+e);o(e),c(e),m(e)},[c,m,a]),tabValues:a}}var j=t(92303);const g="tabList__CuJ",b="tabItem_LNqP";var w=t(74848);function y(e){let{className:n,block:t,selectedValue:s,selectValue:a,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:d}=(0,i.a_)(),c=e=>{const n=e.currentTarget,t=l.indexOf(n),r=o[t].value;r!==s&&(d(n),a(r))},h=e=>{var n;let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{var s;const n=l.indexOf(e.currentTarget)+1;t=null!=(s=l[n])?s:l[0];break}case"ArrowLeft":{var r;const n=l.indexOf(e.currentTarget)-1;t=null!=(r=l[n])?r:l[l.length-1];break}}null==(n=t)||n.focus()};return(0,w.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},n),children:o.map(e=>{let{value:n,label:t,attributes:a}=e;return(0,w.jsx)("li",Object.assign({role:"tab",tabIndex:s===n?0:-1,"aria-selected":s===n,ref:e=>{l.push(e)},onKeyDown:h,onClick:c},a,{className:(0,r.A)("tabs__item",b,null==a?void 0:a.className,{"tabs__item--active":s===n}),children:null!=t?t:n}),n)})})}function v(e){let{lazy:n,children:t,selectedValue:a}=e;const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=i.find(e=>e.props.value===a);return e?(0,s.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,w.jsx)("div",{className:"margin-top--md",children:i.map((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==a}))})}function T(e){const n=m(e);return(0,w.jsxs)("div",{className:(0,r.A)(a.G.tabs.container,"tabs-container",g),children:[(0,w.jsx)(y,Object.assign({},n,e)),(0,w.jsx)(v,Object.assign({},n,e))]})}function k(e){const n=(0,j.A)();return(0,w.jsx)(T,Object.assign({},e,{children:f(e.children)}),String(n))}},19365(e,n,t){t.d(n,{A:()=>i});t(96540);var s=t(34164);const r="tabItem_Ymn6";var a=t(74848);function i(e){let{children:n,hidden:t,className:i}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,s.A)(r,i),hidden:t,children:n})}},20423(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"develop/manifests","title":"Manifests (\\"Virtual Filesystem\\")","description":"Under construction, set for major revisions.","source":"@site/docs/develop/manifests.md","sourceDirName":"develop","slug":"/develop/manifests","permalink":"/docs/develop/manifests","draft":false,"unlisted":false,"editUrl":"https://github.com/ethersphere/docs.github.io/blob/master/docs/develop/manifests.md","tags":[],"version":"current","frontMatter":{"title":"Manifests (\\"Virtual Filesystem\\")","id":"manifests","sidebar_label":"Manifests (\\"Virtual Filesystem\\")"},"sidebar":"develop","previous":{"title":"Host a Webpage","permalink":"/docs/develop/host-your-website"},"next":{"title":"Website Routing","permalink":"/docs/develop/routing"}}');var r=t(74848),a=t(28453);t(11470),t(19365);const i={title:'Manifests ("Virtual Filesystem")',id:"manifests",sidebar_label:'Manifests ("Virtual Filesystem")'},o=void 0,l={},d=[{value:"Introduction to Manifests",id:"introduction-to-manifests",level:2},{value:"Manifest Structure Explained",id:"manifest-structure-explained",level:2},{value:"<strong>Node:</strong>",id:"node",level:4},{value:"<strong>Forks:</strong>",id:"forks",level:4},{value:"<strong>Path:</strong>",id:"path",level:4},{value:"<strong>Target:</strong>",id:"target",level:4},{value:"<strong>Putting it together:</strong>",id:"putting-it-together",level:4},{value:"Usage &amp; Example Scripts",id:"usage--example-scripts",level:2},{value:"Pre-requisites:",id:"pre-requisites",level:4},{value:"Uploading and Printing",id:"uploading-and-printing",level:3},{value:"Adding a New File",id:"adding-a-new-file",level:3},{value:"Moving a File",id:"moving-a-file",level:3}];function c(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"Under construction, set for major revisions."})}),"\n",(0,r.jsxs)(n.p,{children:["Bee nodes \u2014 and tools like ",(0,r.jsx)(n.code,{children:"bee-js"})," and ",(0,r.jsx)(n.code,{children:"swarm-cli"})," \u2014 let you upload entire folders of files to Swarm."]}),"\n",(0,r.jsxs)(n.p,{children:["Swarm doesn\u2019t have a traditional file system like your computer does. Instead, when uploading a collection of files, it uses something called a ",(0,r.jsx)(n.strong,{children:"manifest"}),", which acts like a map between relative file paths (like ",(0,r.jsx)(n.code,{children:"/images/cat.jpg"}),") and the actual content stored on Swarm."]}),"\n",(0,r.jsxs)(n.p,{children:["A manifest is stored in a compact binary ",(0,r.jsxs)(n.a,{href:"https://en.wikipedia.org/wiki/Trie",children:["encoded ",(0,r.jsx)(n.strong,{children:"prefix trie"})]}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["A prefix trie is like a tree that stores file paths by breaking them into shared chunks. For example, ",(0,r.jsx)(n.code,{children:"images/cat.jpg"})," and ",(0,r.jsx)(n.code,{children:"images/dog.jpg"})," both start with ",(0,r.jsx)(n.code,{children:"images/"}),", so they share a common branch."]}),"\n",(0,r.jsxs)(n.p,{children:["This ",(0,r.jsx)(n.em,{children:"saves space"})," and ",(0,r.jsx)(n.em,{children:"makes lookups fast"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Each entry in the manifest includes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["a part of the file path (like ",(0,r.jsx)(n.code,{children:"images/"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"a reference to the file's data (its Swarm hash)"}),"\n",(0,r.jsx)(n.li,{children:"optional metadata (such as file name or content type)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"With manifests, Swarm can serve your content at readable URLs while still storing it securely and immutably."}),"\n",(0,r.jsx)(n.p,{children:"Manifests give Swarm two powerful features:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["A ",(0,r.jsx)(n.strong,{children:"filesystem-like structure"})," that preserves the directory layout of uploaded folders."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Clean, customizable website routing"}),", such as mapping ",(0,r.jsx)(n.code,{children:"/about"}),", ",(0,r.jsx)(n.code,{children:"/about/"}),", and ",(0,r.jsx)(n.code,{children:"/about.html"})," to the same file or redirecting old paths to new ones."]}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsxs)(n.p,{children:["Manifests are stored on Swarm as raw binary data.",(0,r.jsx)(n.br,{}),"\n","To work with them, these bytes must be ",(0,r.jsxs)(n.a,{href:"https://en.wikipedia.org/wiki/Marshalling_(computer_science)",children:[(0,r.jsx)(n.strong,{children:"unmarshalled"})," (decoded)"]})," into a structured form."]}),(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"bee-js"})," provides this functionality through the ",(0,r.jsx)(n.code,{children:"MantarayNode.umarshal"})," method."]}),(0,r.jsxs)(n.p,{children:["After unmarshalling, the data is still quite low-level (for example, many fields are ",(0,r.jsx)(n.code,{children:"Uint8Array"})," values) and usually needs additional processing to make it human-readable. You can find a ",(0,r.jsxs)(n.a,{href:"https://github.com/ethersphere/examples/blob/main/manifests/manifestToJson.js",children:["script for this in the ",(0,r.jsx)(n.code,{children:"ethersphere/examples"})," repo"]}),"."]})]}),"\n",(0,r.jsx)(n.h2,{id:"introduction-to-manifests",children:"Introduction to Manifests"}),"\n",(0,r.jsxs)(n.p,{children:["Whenever you upload a folder using Bee\u2019s ",(0,r.jsxs)(n.a,{href:"https://docs.ethswarm.org/api/#tag/BZZ",children:[(0,r.jsx)(n.code,{children:"/bzz"})," endpoint"]})," (and tools built on top of it such as ",(0,r.jsx)(n.code,{children:"bee-js"})," and ",(0,r.jsx)(n.code,{children:"swarm-cli"}),"), Bee automatically creates a manifest that records:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"every file inside the folder"}),"\n",(0,r.jsx)(n.li,{children:"the file\u2019s relative path"}),"\n",(0,r.jsx)(n.li,{children:"metadata (content type, filename, etc.)"}),"\n",(0,r.jsxs)(n.li,{children:["optional website metadata (",(0,r.jsx)(n.a,{href:"https://docs.ethswarm.org/api/#tag/BZZ/paths/~1bzz/post",children:"index document, error document"}),")"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Uploads made through the Bee API using ",(0,r.jsx)(n.code,{children:"/bytes"})," or ",(0,r.jsx)(n.code,{children:"/chunks"})," ",(0,r.jsx)(n.strong,{children:"do not"})," create manifests."]}),"\n",(0,r.jsx)(n.p,{children:"However, these endpoints are typically used only for custom use cases requiring lower level control, and are not required for standard use cases such as storing and retrieving files and hosting websites or dapps."}),"\n",(0,r.jsxs)(n.p,{children:["Because ",(0,r.jsx)(n.code,{children:"bee-js"})," and ",(0,r.jsx)(n.code,{children:"swarm-cli"})," call ",(0,r.jsx)(n.code,{children:"/bzz"})," when appropriate, ",(0,r.jsx)(n.strong,{children:"you get a manifest automatically"})," whenever you upload a directory."]}),"\n",(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsxs)(n.p,{children:["Although working with a manifest may ",(0,r.jsx)(n.em,{children:"feel"})," like moving or deleting files in a regular filesystem, ",(0,r.jsx)(n.strong,{children:"no data on Swarm is ever changed"}),", because all content is immutable."]}),(0,r.jsxs)(n.p,{children:['When you "modify" a manifest, you\u2019re actually creating a ',(0,r.jsx)(n.em,{children:"new"})," manifest based on the previous one."]}),(0,r.jsx)(n.p,{children:"Removing an entry only removes it from the manifest \u2014 the underlying file remains available as long as its postage batch is valid."})]}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsxs)(n.p,{children:["You can find complete examples of all manifest scripts in the ethersphere/examples repo under",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.a,{href:"https://github.com/ethersphere/examples/tree/main/manifests",children:(0,r.jsx)(n.code,{children:"/manifests"})}),"."]}),(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"bee-js"})," ",(0,r.jsx)(n.a,{href:"https://github.com/ethersphere/bee-js/blob/master/cheatsheet.ts",children:(0,r.jsx)(n.code,{children:"cheatsheet.ts"})})," and",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.a,{href:"https://github.com/ethersphere/bee-js/blob/master/src/manifest/manifest.ts",children:"manifest source code"}),(0,r.jsx)(n.br,{}),"\n","are also excellent references."]})]}),"\n",(0,r.jsx)(n.h2,{id:"manifest-structure-explained",children:"Manifest Structure Explained"}),"\n",(0,r.jsxs)(n.p,{children:["The printed output below shows a ",(0,r.jsx)(n.strong,{children:"decoded Mantaray manifest"})," (printed using the ",(0,r.jsx)(n.code,{children:"printManifestJson"})," method from the ",(0,r.jsxs)(n.a,{href:"https://github.com/ethersphere/examples/blob/main/manifests/manifestToJson.js",children:[(0,r.jsx)(n.code,{children:"manifestToJson.js"})," script in the examples repo"]}),"), represented as a tree of nodes and forks. Each part plays a specific role in describing how file paths map to Swarm content:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "path": "/",\n    "target": "0x0000000000000000000000000000000000000000000000000000000000000000",\n    "metadata": null,\n    "forks": {\n        "folder/": {\n            "path": "folder/",\n            "target": "0x0000000000000000000000000000000000000000000000000000000000000000",\n            "metadata": null,\n            "forks": {\n                "nested.txt": {\n                    "path": "nested.txt",\n                    "target": "0x9442e445c0d58adea58e0a8afcdcc28ed7642d7a4ff9a253e8f1595faafbb808",\n                    "metadata": {\n                        "Content-Type": "text/plain; charset=utf-8",\n                        "Filename": "nested.txt"\n                    },\n                    "forks": {}\n                },\n                "subfolder/deep.txt": {\n                    "path": "subfolder/deep.txt",\n                    "target": "0x6aa935879ad2a547e57ea6350338bd04ad758977b542e86b31c159f31834b8fc",\n                    "metadata": {\n                        "Content-Type": "text/plain; charset=utf-8",\n                        "Filename": "deep.txt"\n                    },\n                    "forks": {}\n                }\n            }\n        },\n        "root.txt": {\n            "path": "root.txt",\n            "target": "0x98e63f7e826a01634881874246fc873cdf06bb5409ff5f9ec61d1e2de1dd3bf6",\n            "metadata": {\n                "Content-Type": "text/plain; charset=utf-8",\n                "Filename": "root.txt"\n            },\n            "forks": {}\n        }\n    }\n}\n\n'})}),"\n",(0,r.jsx)(n.p,{children:"Here\u2019s what each piece means:"}),"\n",(0,r.jsx)(n.h4,{id:"node",children:(0,r.jsx)(n.strong,{children:"Node:"})}),"\n",(0,r.jsxs)(n.p,{children:["A ",(0,r.jsx)(n.strong,{children:"Node"})," represents a position within the manifest trie.\nEach node corresponds to a ",(0,r.jsx)(n.strong,{children:"path prefix"}),"\u2014a segment of the full file path."]}),"\n",(0,r.jsx)(n.p,{children:"For example:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["A node with ",(0,r.jsx)(n.code,{children:"path: folder/"})," represents the prefix ",(0,r.jsx)(n.code,{children:'"folder/"'}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["A node with ",(0,r.jsx)(n.code,{children:"path: nested.txt"})," represents a leaf for the file ",(0,r.jsx)(n.code,{children:'"nested.txt"'}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Every node may contain:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["a path segment (",(0,r.jsx)(n.code,{children:"path"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["zero or more child connections (",(0,r.jsx)(n.code,{children:"forks"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"optional metadata (e.g., content-type, filename)"}),"\n",(0,r.jsxs)(n.li,{children:["a ",(0,r.jsx)(n.code,{children:"target"})," (if the node corresponds to an actual file)"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"forks",children:(0,r.jsx)(n.strong,{children:"Forks:"})}),"\n",(0,r.jsxs)(n.p,{children:["A ",(0,r.jsx)(n.strong,{children:"fork"})," is an ",(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Glossary_of_graph_theory#edge",children:"edge"})," from one node to another.\nIt is how the trie branches when file paths diverge."]}),"\n",(0,r.jsxs)(n.p,{children:["For example, under ",(0,r.jsx)(n.code,{children:"folder/"}),", you see:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"forks:\n  nested.txt/\n  subfolder/deep.txt/\n"})}),"\n",(0,r.jsx)(n.p,{children:"This means:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["the ",(0,r.jsx)(n.code,{children:"folder/"})," node has two children"]}),"\n",(0,r.jsx)(n.li,{children:"those children represent different path continuations (i.e., different files)"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Forks are how shared prefixes are stored only once. Everything that starts with ",(0,r.jsx)(n.code,{children:"folder/"})," branches from the same node."]}),"\n",(0,r.jsx)(n.h4,{id:"path",children:(0,r.jsx)(n.strong,{children:"Path:"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"path"})," is the ",(0,r.jsx)(n.strong,{children:"path segment stored at that node"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"path: root.txt"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"path: nested.txt"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"path: subfolder/deep.txt"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["These are ",(0,r.jsx)(n.em,{children:"not"})," full paths.\nThey represent only the part needed at that position in the trie.\nThe full path is reconstructed by walking from the root down through forks."]}),"\n",(0,r.jsx)(n.h4,{id:"target",children:(0,r.jsx)(n.strong,{children:"Target:"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"target"})," field holds the ",(0,r.jsx)(n.strong,{children:"Swarm hash of the file the node points to"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"target: 0x9442e445c0d58a...\n"})}),"\n",(0,r.jsx)(n.p,{children:"This hash is the immutable reference of the actual content uploaded to Swarm."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["Why is the target sometimes ",(0,r.jsx)(n.code,{children:"0x000000...000"}),"?"]})}),"\n",(0,r.jsxs)(n.p,{children:["Because ",(0,r.jsx)(n.strong,{children:"not every node corresponds to a file"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Nodes represent ",(0,r.jsx)(n.strong,{children:"prefixes"}),", not necessarily files."]}),"\n",(0,r.jsx)(n.p,{children:"For example:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The root node (",(0,r.jsx)(n.code,{children:"Node:"})," at the top) has no file associated so its ",(0,r.jsx)(n.code,{children:"target"})," is zero."]}),"\n",(0,r.jsxs)(n.li,{children:["The node for ",(0,r.jsx)(n.code,{children:"folder/"})," also has no file associated \u2192 target is zero.\nIt is just an internal directory-like prefix."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Only ",(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Glossary_of_graph_theory#leaf",children:(0,r.jsx)(n.strong,{children:"leaf nodes"})})," where a file actually exists, have a non-zero target (the file\u2019s Swarm reference)."]}),"\n",(0,r.jsx)(n.p,{children:"So:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Node type"}),(0,r.jsx)(n.th,{children:"Example"}),(0,r.jsx)(n.th,{children:"Has file?"}),(0,r.jsx)(n.th,{children:"Target"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Internal directory node"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"folder/"})}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"0x000...000"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Leaf node"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nested.txt"})}),(0,r.jsx)(n.td,{children:"Yes"}),(0,r.jsx)(n.td,{children:"real hash"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Root node"}),(0,r.jsx)(n.td,{children:"(top of tree)"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"0x000...000"})})]})]})]}),"\n",(0,r.jsxs)(n.admonition,{type:"warning",children:[(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"target"})," field in a manifest points to the raw file root chunk, not a manifest. ",(0,r.jsx)(n.code,{children:"bee-js"})," and ",(0,r.jsx)(n.code,{children:"swarm-cli"})," file download functions expect a file manifest, even for single-file uploads, so downloading using the raw target hash will not work properly.\nInstead, download files by using the top-level directory root manifest plus the file path relative to the root hash as it is represented in the manifest trie."]}),(0,r.jsx)(n.p,{children:"Example:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl http://127.0.0.1:1633/bzz/4d5e6e3eb532131e128b1cd0400ca249f1a6ce5d4005c0b57bf848131300df9d/folder/subfolder/deep.txt\n"})}),(0,r.jsx)(n.p,{children:"Terminal output:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"DEEP\n"})})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Metadata:"})}),"\n",(0,r.jsx)(n.p,{children:"Metadata stores information about a file, such as:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Content-Type"}),"\n",(0,r.jsx)(n.li,{children:"Filename"}),"\n",(0,r.jsx)(n.li,{children:"Website index/error docs (if configured)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"metadata:\n  Content-Type: text/plain; charset=utf-8\n  Filename: nested.txt\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Only ",(0,r.jsx)(n.strong,{children:"file nodes"})," (leaf nodes) normally have metadata.\nInternal nodes generally do not."]}),"\n",(0,r.jsx)(n.p,{children:"Metadata helps:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"gateways set HTTP headers (e.g., correct MIME type)"}),"\n",(0,r.jsx)(n.li,{children:"browsers display files correctly"}),"\n",(0,r.jsx)(n.li,{children:"filesystem-like behavior"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"putting-it-together",children:(0,r.jsx)(n.strong,{children:"Putting it together:"})}),"\n",(0,r.jsx)(n.p,{children:"Let\u2019s interpret a branch:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"folder/\n  nested.txt\n"})}),"\n",(0,r.jsx)(n.p,{children:"This means:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["There is a prefix node representing ",(0,r.jsx)(n.code,{children:'"folder/"'}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Inside it, there is a file ",(0,r.jsx)(n.code,{children:'"nested.txt"'}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"The file node has:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"a target (its Swarm content hash)"}),"\n",(0,r.jsx)(n.li,{children:"metadata (filename + content-type)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Meanwhile, ",(0,r.jsx)(n.code,{children:'"folder/"'})," has ",(0,r.jsx)(n.strong,{children:"no file itself"}),", so its target is zero."]}),"\n",(0,r.jsx)(n.h2,{id:"usage--example-scripts",children:"Usage & Example Scripts"}),"\n",(0,r.jsxs)(n.p,{children:["In this section we explain how to inspect and modify manifests for non-website directories. You can find the completed ",(0,r.jsx)(n.a,{href:"https://github.com/ethersphere/examples/tree/main/manifests/directory",children:"example scripts on GitHub"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"In the following guides we will explain how to:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Upload a directory and print its manifest"}),"\n",(0,r.jsx)(n.li,{children:"Add a new file"}),"\n",(0,r.jsx)(n.li,{children:"Move a file (delete + add new entry)"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"pre-requisites",children:"Pre-requisites:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"NodeJS and npm"}),"\n",(0,r.jsx)(n.li,{children:"Linux or WSL preferred but most commands should work from windows Powershell with slight modifications"}),"\n",(0,r.jsx)(n.li,{children:"git"}),"\n",(0,r.jsxs)(n.li,{children:["The RPC endpoint for a currently running Bee node (either on your machine or remote, try ",(0,r.jsx)(n.a,{href:"https://www.ethswarm.org/build/desktop",children:"Swarm Desktop"})," for a no-hassle way to get started)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["If you'd like to follow along with the guides shown below, clone the ",(0,r.jsxs)(n.a,{href:"https://github.com/ethersphere/examples/",children:[(0,r.jsx)(n.code,{children:"ethersphere/examples"})," repo"]})," and navigate to the ",(0,r.jsx)(n.code,{children:"/manifests"})," folder:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git clone git@github.com:ethersphere/examples.git\ncd examples/manifests/\n"})}),"\n",(0,r.jsx)(n.p,{children:"Print the file tree to confirm you're in the right place:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"user@machine:~/examples/manifests$ tree\n.\n\u251c\u2500\u2500 directory\n\u2502\xa0\xa0 \u251c\u2500\u2500 folder\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 nested.txt\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 subfolder\n\u2502\xa0\xa0 \u2502\xa0\xa0     \u2514\u2500\u2500 deep.txt\n\u2502\xa0\xa0 \u2514\u2500\u2500 root.txt\n\u251c\u2500\u2500 env\n\u251c\u2500\u2500 manifestToJson.js\n\u251c\u2500\u2500 package-lock.json\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 script-01.js\n\u251c\u2500\u2500 script-02.js\n\u2514\u2500\u2500 script-03.js\n"})}),"\n",(0,r.jsxs)(n.p,{children:["If you're using Powershell you can use the ",(0,r.jsx)(n.code,{children:"tree /f"})," command instead and the output file tree should look similar."]}),"\n",(0,r.jsxs)(n.p,{children:["After confirming, run ",(0,r.jsx)(n.code,{children:"npm install"})," to install dependencies:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm install\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Locate the ",(0,r.jsx)(n.code,{children:"env"})," file and add a period/full stop to change the file name to a standard ",(0,r.jsx)(n.code,{children:"dotenv"})," file (",(0,r.jsx)(n.code,{children:".env"}),"). Then modify the file to replace ",(0,r.jsx)(n.code,{children:"<BEE_API_ENDPOINT>"})," with your RPC endpoint and ",(0,r.jsx)(n.code,{children:"<BATCH_ID>"})," with your own postage batch ID:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"BEE_RPC_URL=<BEE_API_ENDPOINT> // Default: http://localhost:1633\nPOSTAGE_BATCH_ID=<BATCH_ID>\n"})}),"\n",(0,r.jsx)(n.p,{children:"Great! Now you're all set up and ready to go."}),"\n",(0,r.jsx)(n.h3,{id:"uploading-and-printing",children:"Uploading and Printing"}),"\n",(0,r.jsx)(n.p,{children:"In our first script, we will simply upload our sample directory and print its contents:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"script-01.js (initial upload script)"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'import { Bee, MantarayNode } from "@ethersphere/bee-js";\nimport path from "path";\nimport { fileURLToPath } from "url";\nimport "dotenv/config";\nimport { printManifest } from "./printManifest.js";\n\n// Recreate __dirname for ES modules\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nconst bee = new Bee(process.env.BEE_RPC_URL);\nconst postageBatchId = process.env.POSTAGE_BATCH_ID;\n\n// Build the folder path safely\nconst directoryPath = path.join(__dirname, "directory");\n\nasync function uploadDirectory() {\n  try {\n    console.log("Uploading directory:", directoryPath);\n\n    // Upload using the resolved directory and get manifest reference\n    const { reference } = await bee.uploadFilesFromDirectory(\n      postageBatchId,\n      directoryPath\n    );\n\n    console.log("Directory uploaded successfully!");\n    console.log("Manifest reference:", reference.toHex());\n\n    // Download each file using its relative path as recorded by the manifest\n    const root = await bee.downloadFile(reference, "root.txt");\n    const nested = await bee.downloadFile(reference, "folder/nested.txt");\n    const deep = await bee.downloadFile(reference, "folder/subfolder/deep.txt");\n\n    // Print out file contents\n    console.log("root.txt:", root.data.toUtf8());\n    console.log("folder/nested.txt:", nested.data.toUtf8());\n    console.log("folder/subfolder/deep.txt:", deep.data.toUtf8());\n\n    // Load the generated manifest\n    const node = await MantarayNode.unmarshal(bee, reference);\n    await node.loadRecursively(bee);\n\n    // Print manifest in human readable format\n    console.log("\\n--- Manifest Tree ---");\n    printManifest(node);\n  } catch (error) {\n    console.error("Error during upload or download:", error.message);\n  }\n}\n\nuploadDirectory();\n'})}),"\n",(0,r.jsx)(n.p,{children:"Note that in the script when downloading our files individually we must use the same relative paths that match the directory we uploaded:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'// Download each file using its relative path as recorded by the manifest\nconst root = await bee.downloadFile(reference, "root.txt");\nconst nested = await bee.downloadFile(reference, "folder/nested.txt");\nconst deep = await bee.downloadFile(reference, "folder/subfolder/deep.txt");\n'})}),"\n",(0,r.jsx)(n.p,{children:"Run the script:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"node script-01.js\n"})}),"\n",(0,r.jsx)(n.p,{children:"If you've set up everything properly, you should see the file contents printed to the terminal followed by the manifest tree:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'Uploading directory: /home/user/examples/manifests/directory\nDirectory uploaded successfully!\nManifest reference: 4d5e6e3eb532131e128b1cd0400ca249f1a6ce5d4005c0b57bf848131300df9d\nroot.txt: ROOT\nfolder/nested.txt: NESTED\nfolder/subfolder/deep.txt: DEEP\n\n--- Manifest Tree ---\n{\n  "path": "/",\n  "target": "0x0000000000000000000000000000000000000000000000000000000000000000",\n  "metadata": null,\n  "forks": {\n    "folder/": {\n      "path": "folder/",\n      "target": "0x0000000000000000000000000000000000000000000000000000000000000000",\n      "metadata": null,\n      "forks": {\n        "nested.txt": {\n          "path": "nested.txt",\n          "target": "0x9442e445c0d58adea58e0a8afcdcc28ed7642d7a4ff9a253e8f1595faafbb808",\n          "metadata": {\n            "Content-Type": "text/plain; charset=utf-8",\n            "Filename": "nested.txt"\n          },\n          "forks": {}\n        },\n        "subfolder/deep.txt": {\n          "path": "subfolder/deep.txt",\n          "target": "0x6aa935879ad2a547e57ea6350338bd04ad758977b542e86b31c159f31834b8fc",\n          "metadata": {\n            "Content-Type": "text/plain; charset=utf-8",\n            "Filename": "deep.txt"\n          },\n          "forks": {}\n        }\n      }\n    },\n    "root.txt": {\n      "path": "root.txt",\n      "target": "0x98e63f7e826a01634881874246fc873cdf06bb5409ff5f9ec61d1e2de1dd3bf6",\n      "metadata": {\n        "Content-Type": "text/plain; charset=utf-8",\n        "Filename": "root.txt"\n      },\n      "forks": {}\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Note and record the manifest reference returned before the manifest tree is printed:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"Manifest reference: 4d5e6e3eb532131e128b1cd0400ca249f1a6ce5d4005c0b57bf848131300df9d\n"})}),"\n",(0,r.jsx)(n.p,{children:"We will use this in the next section when adding a file manually to the manifest."}),"\n",(0,r.jsx)(n.h3,{id:"adding-a-new-file",children:"Adding a New File"}),"\n",(0,r.jsxs)(n.p,{children:["This script uploads a ",(0,r.jsx)(n.strong,{children:"new file"})," (e.g. ",(0,r.jsx)(n.code,{children:"newfile.txt"}),") and then updates the existing manifest so the new file becomes part of the directory structure."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"script-02.js"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.em,{children:"The following script is almost identical to script-01.js, only the changed sections will be highlighted. Remember you can always refer to the complete version of the script in the examples repo."})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"\nimport \"dotenv/config\"\nimport { Bee, MantarayNode } from \"@ethersphere/bee-js\"\nimport { printManifestJson } from './manifestToJson.js'\n\nconst bee = new Bee(process.env.BEE_RPC_URL)\nconst batchId = process.env.POSTAGE_BATCH_ID\n\n// We specify the manifest returned from script-01.js here\nconst ROOT_MANIFEST = '4d5e6e3eb532131e128b1cd0400ca249f1a6ce5d4005c0b57bf848131300df9d'\n\nasync function addFileToManifest() {\n    try {\n        // Load the generated manifest from script-01.js\n        const node = await MantarayNode.unmarshal(bee, ROOT_MANIFEST)\n        await node.loadRecursively(bee)\n\n        // File details for new file\n        const filename = 'new.txt'\n        const content = \"Hi, I'm new here.\"\n        const bytes = new TextEncoder().encode(content)\n\n        // Upload raw file data \n        // Note we use \"bee.uploadData()\", not \"bee.uploadFile()\", since we need the root reference hash of the content, not a manifest reference. \n        const { reference } = await bee.uploadData(batchId, bytes)\n        console.log('Uploaded raw reference:', reference.toHex())\n\n        // Metadata must be a plain JS object \u2014 NOT a Map or Uint8Array\n        const metadata = {\n            'Content-Type': 'text/plain; charset=utf-8',\n            'Filename': filename,\n        }\n\n        // Insert the new file data into our new manifest\n        node.addFork(filename, reference, metadata)\n\n        // Save and print updated manifest\n        const newManifest = await node.saveRecursively(bee, batchId)\n        const newReference = newManifest.reference\n        console.log('Updated manifest hash:', newReference.toHex())\n        printManifestJson(node)\n\n        // Download new file and print its contents\n        const newFile = await bee.downloadFile(newReference, \"new.txt\")\n        console.log(\"new.txt:\", newFile.data.toUtf8())\n\n    }\n    catch (error) {\n        console.error(\"Error during upload or download:\", error.message)\n    }\n}\n\naddFileToManifest()\n"})}),"\n",(0,r.jsx)(n.p,{children:"Terminal output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'noah@NoahM16:~/examples/manifests$ node script-02.js\nUploaded raw reference: 3515db2f5e3c075b7546d7dd7dea1680c3e0785c6584e66b7e4f56fc344a0a78\nUpdated manifest hash: 4f67218844a814655c8d81aae4c4286a142318d672113973360c33c7930ce2f5\n{\n    "path": "/",\n    "target": "0x0000000000000000000000000000000000000000000000000000000000000000",\n    "metadata": null,\n    "forks": {\n        "folder/": {\n            "path": "folder/",\n            "target": "0x0000000000000000000000000000000000000000000000000000000000000000",\n            "metadata": null,\n            "forks": {\n                "nested.txt": {\n                    "path": "nested.txt",\n                    "target": "0x9442e445c0d58adea58e0a8afcdcc28ed7642d7a4ff9a253e8f1595faafbb808",\n                    "metadata": {\n                        "Content-Type": "text/plain; charset=utf-8",\n                        "Filename": "nested.txt"\n                    },\n                    "forks": {}\n                },\n                "subfolder/deep.txt": {\n                    "path": "subfolder/deep.txt",\n                    "target": "0x6aa935879ad2a547e57ea6350338bd04ad758977b542e86b31c159f31834b8fc",\n                    "metadata": {\n                        "Content-Type": "text/plain; charset=utf-8",\n                        "Filename": "deep.txt"\n                    },\n                    "forks": {}\n                }\n            }\n        },\n        "root.txt": {\n            "path": "root.txt",\n            "target": "0x98e63f7e826a01634881874246fc873cdf06bb5409ff5f9ec61d1e2de1dd3bf6",\n            "metadata": {\n                "Content-Type": "text/plain; charset=utf-8",\n                "Filename": "root.txt"\n            },\n            "forks": {}\n        },\n        "new.txt": {\n            "path": "new.txt",\n            "target": "0x3515db2f5e3c075b7546d7dd7dea1680c3e0785c6584e66b7e4f56fc344a0a78",\n            "metadata": {\n                "Content-Type": "text/plain; charset=utf-8",\n                "Filename": "new.txt"\n            },\n            "forks": {}\n        }\n    }\n}\nnew.txt: Hi, I\'m new here.\n'})}),"\n",(0,r.jsxs)(n.p,{children:["This produces a new manifest where ",(0,r.jsx)(n.code,{children:"/new.txt"})," is now accessible as a root level entry."]}),"\n",(0,r.jsx)(n.h3,{id:"moving-a-file",children:"Moving a File"}),"\n",(0,r.jsx)(n.p,{children:"This script:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Removes ",(0,r.jsx)(n.code,{children:"/new.txt"})," from the manifest"]}),"\n",(0,r.jsxs)(n.li,{children:["Adds it back under ",(0,r.jsx)(n.code,{children:"/nested/deeper/new.txt"})]}),"\n",(0,r.jsx)(n.li,{children:"Prints the updated manifest"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"script-03.js"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'import "dotenv/config"\nimport { Bee, MantarayNode } from "@ethersphere/bee-js"\nimport { printManifestJson } from \'./manifestToJson.js\'\n\nconst bee = new Bee(process.env.BEERPC_URL || process.env.BEE_RPC_URL)\nconst batchId = process.env.POSTAGE_BATCH_ID\n\n// Manifest returned from script-02.js\nconst ROOT_MANIFEST = \'SCRIPT_2_MANIFEST\'\n\nasync function moveFileInManifest() {\n    try {\n        // Load manifest generated in script-02\n        const node = await MantarayNode.unmarshal(bee, ROOT_MANIFEST)\n        await node.loadRecursively(bee)\n\n        // Reload manifest to capture original file reference *before* deletion\n        const original = await MantarayNode.unmarshal(bee, ROOT_MANIFEST)\n        await original.loadRecursively(bee)\n\n        const existing = original.find("new.txt")\n        if (!existing) {\n            throw new Error("Could not retrieve file reference for new.txt \u2014 run script-02.js first.")\n        }\n\n        const fileRef = existing.targetAddress\n\n        // STEP 1 \u2014 Remove /new.txt\n        node.removeFork("new.txt")\n        console.log("Removed /new.txt from manifest.")\n\n        // STEP 2 \u2014 Re-add under /nested/deeper/new.txt\n        const newPath = "nested/deeper/new.txt"\n\n        node.addFork(\n            newPath,\n            fileRef,\n            {\n                "Content-Type": "text/plain; charset=utf-8",\n                "Filename": "new.txt"\n            }\n        )\n\n        console.log(`Added file under /${newPath}`)\n\n        // STEP 3 \u2014 Save updated manifest\n        const updated = await node.saveRecursively(bee, batchId)\n        const newManifestRef = updated.reference.toHex()\n\n        console.log("Updated manifest hash:", newManifestRef)\n\n        // STEP 4 \u2014 Print JSON\n        printManifestJson(node)\n\n        // STEP 5 \u2014 Download the file from its new location and print contents\n        const downloaded = await bee.downloadFile(updated.reference, newPath)\n        console.log(`\\nContents of /${newPath}:`)\n        console.log(downloaded.data.toUtf8())\n\n    } catch (error) {\n        console.error("Error while modifying manifest:", error.message)\n    }\n}\n\nmoveFileInManifest()\n'})}),"\n",(0,r.jsx)(n.p,{children:"Terminal output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'user@machine:~/examples/manifests$ node script-03.js\nRemoved /new.txt from manifest.\nAdded file under /nested/deeper/new.txt\nUpdated manifest hash: 656ea924fb4d98b7fa327eb9e4d98ece6c2f4370515d23b40dfca71bc99a08a6\n{\n    "path": "/",\n    "target": "0x0000000000000000000000000000000000000000000000000000000000000000",\n    "metadata": null,\n    "forks": {\n        "folder/": {\n            "path": "folder/",\n            "target": "0x0000000000000000000000000000000000000000000000000000000000000000",\n            "metadata": null,\n            "forks": {\n                "nested.txt": {\n                    "path": "nested.txt",\n                    "target": "0x9442e445c0d58adea58e0a8afcdcc28ed7642d7a4ff9a253e8f1595faafbb808",\n                    "metadata": {\n                        "Content-Type": "text/plain; charset=utf-8",\n                        "Filename": "nested.txt"\n                    },\n                    "forks": {}\n                },\n                "subfolder/deep.txt": {\n                    "path": "subfolder/deep.txt",\n                    "target": "0x6aa935879ad2a547e57ea6350338bd04ad758977b542e86b31c159f31834b8fc",\n                    "metadata": {\n                        "Content-Type": "text/plain; charset=utf-8",\n                        "Filename": "deep.txt"\n                    },\n                    "forks": {}\n                }\n            }\n        },\n        "root.txt": {\n            "path": "root.txt",\n            "target": "0x98e63f7e826a01634881874246fc873cdf06bb5409ff5f9ec61d1e2de1dd3bf6",\n            "metadata": {\n                "Content-Type": "text/plain; charset=utf-8",\n                "Filename": "root.txt"\n            },\n            "forks": {}\n        },\n        "nested/deeper/new.txt": {\n            "path": "nested/deeper/new.txt",\n            "target": "0x3515db2f5e3c075b7546d7dd7dea1680c3e0785c6584e66b7e4f56fc344a0a78",\n            "metadata": {\n                "Content-Type": "text/plain; charset=utf-8",\n                "Filename": "new.txt"\n            },\n            "forks": {}\n        }\n    }\n}\n\nContents of /nested/deeper/new.txt:\nHi, I\'m new here.\n'})}),"\n",(0,r.jsx)(n.p,{children:"Now the file appears under:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"/nested/deeper/root.txt\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Note that the only new method we used was ",(0,r.jsx)(n.code,{children:"node.removeFork()"})," to remove the entry from the manifest."]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453(e,n,t){t.d(n,{R:()=>i,x:()=>o});var s=t(96540);const r={},a=s.createContext(r);function i(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);