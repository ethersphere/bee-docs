"use strict";(self.webpackChunkbee_docs=self.webpackChunkbee_docs||[]).push([[632],{11470(e,n,t){t.d(n,{A:()=>N});var a=t(96540),s=t(34164),i=t(17559),r=t(23104),o=t(56347),l=t(205),d=t(57485),c=t(31682),h=t(70679);function u(e){var n,t;return null!=(n=null==(t=a.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')}))?void 0:t.filter(Boolean))?n:[]}function p(e){const{values:n,children:t}=e;return(0,a.useMemo)(()=>{const e=null!=n?n:function(e){return u(e).map(e=>{let{props:{value:n,label:t,attributes:a,default:s}}=e;return{value:n,label:t,attributes:a,default:s}})}(t);return function(e){const n=(0,c.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map(e=>e.value).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e},[n,t])}function m(e){let{value:n,tabValues:t}=e;return t.some(e=>e.value===n)}function x(e){let{queryString:n=!1,groupId:t}=e;const s=(0,o.W6)(),i=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=t?t:null}({queryString:n,groupId:t});return[(0,d.aZ)(i),(0,a.useCallback)(e=>{if(!i)return;const n=new URLSearchParams(s.location.search);n.set(i,e),s.replace(Object.assign({},s.location,{search:n.toString()}))},[i,s])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,i=p(e),[r,o]=(0,a.useState)(()=>function(e){var n;let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:a}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+a.map(e=>e.value).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}const s=null!=(n=a.find(e=>e.default))?n:a[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:i})),[d,c]=x({queryString:t,groupId:s}),[u,f]=function(e){let{groupId:n}=e;const t=function(e){return e?"docusaurus.tab."+e:null}(n),[s,i]=(0,h.Dv)(t);return[s,(0,a.useCallback)(e=>{t&&i.set(e)},[t,i])]}({groupId:s}),b=(()=>{const e=null!=d?d:u;return m({value:e,tabValues:i})?e:null})();(0,l.A)(()=>{b&&o(b)},[b]);return{selectedValue:r,selectValue:(0,a.useCallback)(e=>{if(!m({value:e,tabValues:i}))throw new Error("Can't select invalid tab value="+e);o(e),c(e),f(e)},[c,f,i]),tabValues:i}}var b=t(92303);const j="tabList__CuJ",g="tabItem_LNqP";var v=t(74848);function w(e){let{className:n,block:t,selectedValue:a,selectValue:i,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:d}=(0,r.a_)(),c=e=>{const n=e.currentTarget,t=l.indexOf(n),s=o[t].value;s!==a&&(d(n),i(s))},h=e=>{var n;let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{var a;const n=l.indexOf(e.currentTarget)+1;t=null!=(a=l[n])?a:l[0];break}case"ArrowLeft":{var s;const n=l.indexOf(e.currentTarget)-1;t=null!=(s=l[n])?s:l[l.length-1];break}}null==(n=t)||n.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":t},n),children:o.map(e=>{let{value:n,label:t,attributes:i}=e;return(0,v.jsx)("li",Object.assign({role:"tab",tabIndex:a===n?0:-1,"aria-selected":a===n,ref:e=>{l.push(e)},onKeyDown:h,onClick:c},i,{className:(0,s.A)("tabs__item",g,null==i?void 0:i.className,{"tabs__item--active":a===n}),children:null!=t?t:n}),n)})})}function y(e){let{lazy:n,children:t,selectedValue:i}=e;const r=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=r.find(e=>e.props.value===i);return e?(0,a.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:r.map((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==i}))})}function R(e){const n=f(e);return(0,v.jsxs)("div",{className:(0,s.A)(i.G.tabs.container,"tabs-container",j),children:[(0,v.jsx)(w,Object.assign({},n,e)),(0,v.jsx)(y,Object.assign({},n,e))]})}function N(e){const n=(0,b.A)();return(0,v.jsx)(R,Object.assign({},e,{children:u(e.children)}),String(n))}},17695(e,n,t){t.d(n,{A:()=>a});const a=t.p+"assets/images/routing-manifest-7e3a4408af18995c31d40d91bf154672.png"},19365(e,n,t){t.d(n,{A:()=>r});t(96540);var a=t(34164);const s="tabItem_Ymn6";var i=t(74848);function r(e){let{children:n,hidden:t,className:r}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,a.A)(s,r),hidden:t,children:n})}},28453(e,n,t){t.d(n,{R:()=>r,x:()=>o});var a=t(96540);const s={},i=a.createContext(s);function r(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:n},e.children)}},73517(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>p,frontMatter:()=>l,metadata:()=>a,toc:()=>h});const a=JSON.parse('{"id":"develop/routing","title":"Website Routing","description":"Swarm does not behave like a traditional web server \u2014 there is no server-side routing, and every route must correspond to a real file inside the site manifest.","source":"@site/docs/develop/routing.md","sourceDirName":"develop","slug":"/develop/routing","permalink":"/docs/develop/routing","draft":false,"unlisted":false,"editUrl":"https://github.com/ethersphere/docs.github.io/blob/master/docs/develop/routing.md","tags":[],"version":"current","frontMatter":{"title":"Website Routing","id":"routing"},"sidebar":"develop","previous":{"title":"Manage Files","permalink":"/docs/develop/files"},"next":{"title":"Add Access Control","permalink":"/docs/develop/act"}}');var s=t(74848),i=t(28453),r=t(11470),o=t(19365);const l={title:"Website Routing",id:"routing"},d="Routing on Swarm",c={},h=[{value:"Client-Side Hash Routing",id:"client-side-hash-routing",level:2},{value:"1. Create a New Vite + React Project (with <code>create-swarm-app</code>)",id:"1-create-a-new-vite--react-project-with-create-swarm-app",level:4},{value:"2. Install React Router",id:"2-install-react-router",level:4},{value:"3. Switch the App to Use Hash-Based Routing",id:"3-switch-the-app-to-use-hash-based-routing",level:4},{value:"4. Add Your Page Components",id:"4-add-your-page-components",level:4},{value:"5. Add a Static <code>404.html</code> for Non-Hash URLs",id:"5-add-a-static-404html-for-non-hash-urls",level:4},{value:"6. Build the Project",id:"6-build-the-project",level:4},{value:"7. Deploy Site",id:"7-deploy-site",level:4},{value:"Manifest Based Routing",id:"manifest-based-routing",level:2},{value:"1. Upload the Site with Default Manifest",id:"1-upload-the-site-with-default-manifest",level:3},{value:"2. Fix Routing With Manifest Manipulation",id:"2-fix-routing-with-manifest-manipulation",level:3},{value:"Add Routing Behavior by Manifest Manipulation",id:"add-routing-behavior-by-manifest-manipulation",level:4},{value:"3. Remove Routes and Add New Ones",id:"3-remove-routes-and-add-new-ones",level:3},{value:"4. Manifest Routing Enables Dynamic Content",id:"4-manifest-routing-enables-dynamic-content",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"routing-on-swarm",children:"Routing on Swarm"})}),"\n",(0,s.jsxs)(n.p,{children:["Swarm does not behave like a traditional web server \u2014 there is no server-side routing, and every route must correspond to a real file inside the site ",(0,s.jsx)(n.a,{href:"/docs/develop/tools-and-features/manifests",children:"manifest"}),"."]}),"\n",(0,s.jsx)(n.p,{children:'If you try to use typical "clean URLs" like:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"/about\n/contact\n/dashboard/settings\n"})}),"\n",(0,s.jsx)(n.p,{children:"Swarm will look for literal files such as:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"about\ncontact\ndashboard/settings\n"})}),"\n",(0,s.jsxs)(n.p,{children:["...which don\u2019t exist if you've uploaded a static website with files like ",(0,s.jsx)(n.code,{children:"about.html"})," and ",(0,s.jsx)(n.code,{children:"contact.html"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"There are two main strategies for addressing routing:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Hash-Based Client-Side Routing"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Manifest-Based Routing with Aliases or Index Files"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Now let\u2019s look at each method:"}),"\n",(0,s.jsx)(n.h2,{id:"client-side-hash-routing",children:"Client-Side Hash Routing"}),"\n",(0,s.jsx)(n.p,{children:"This section explains how to add hash based client side routing to your Swarm hosted site so that you can have clean URLs for each page of your website."}),"\n",(0,s.jsxs)(n.p,{children:["See the ",(0,s.jsx)(n.a,{href:"https://github.com/ethersphere/examples/tree/main/routing",children:"routing project in the examples repo"})," for a full working example implementation."]}),"\n",(0,s.jsxs)(n.p,{children:["Swarm has no server backend running code and so can\u2019t rewrite paths. One approach to routing is to set up a ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Single-page_application",children:"SPA"})," with React's ",(0,s.jsx)(n.code,{children:"HashRouter"}),", which keeps all routing inside the browser."]}),"\n",(0,s.jsxs)(n.p,{children:["You can do this easily using a template from ",(0,s.jsx)(n.strong,{children:"create-swarm-app"})," and then adding your own pages."]}),"\n",(0,s.jsxs)(n.h4,{id:"1-create-a-new-vite--react-project-with-create-swarm-app",children:["1. Create a New Vite + React Project (with ",(0,s.jsx)(n.code,{children:"create-swarm-app"}),")"]}),"\n",(0,s.jsx)(n.p,{children:"Run:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm init swarm-app@latest my-dapp vite-tsx\n"})}),"\n",(0,s.jsx)(n.p,{children:"This generates a clean project containing:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"src/\n  App.tsx\n  index.tsx\n  config.ts\npublic/\nindex.html\npackage.json\n"})}),"\n",(0,s.jsx)(n.p,{children:"You now have a fully working Vite/React app ready for Swarm uploads."}),"\n",(0,s.jsx)(n.h4,{id:"2-install-react-router",children:"2. Install React Router"}),"\n",(0,s.jsx)(n.p,{children:"Navigate to the project directory:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd my-dapp\n"})}),"\n",(0,s.jsx)(n.p,{children:"Inside the project:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install react-router-dom\n"})}),"\n",(0,s.jsx)(n.p,{children:"This gives you client-side navigation capability."}),"\n",(0,s.jsx)(n.h4,{id:"3-switch-the-app-to-use-hash-based-routing",children:"3. Switch the App to Use Hash-Based Routing"}),"\n",(0,s.jsxs)(n.p,{children:["Swarm only serves literal files, so ",(0,s.jsx)(n.code,{children:"/#/about"})," is the only reliable way to have \u201cpages.\u201d"]}),"\n",(0,s.jsxs)(n.p,{children:["Replace your ",(0,s.jsx)(n.code,{children:"./src/App.tsx"})," with:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"import { HashRouter, Routes, Route, Link } from 'react-router-dom'\nimport { Home } from './Home'\nimport { About } from './About'\nimport { NotFound } from './NotFound'\n\nexport function App() {\n    return (\n        <HashRouter>\n            <nav style={{ display: 'flex', gap: '12px', padding: '12px' }}>\n                <Link to=\"/\">Home</Link>\n                <Link to=\"/about\">About</Link>\n            </nav>\n\n            <Routes>\n                <Route path=\"/\" element={<Home />} />\n                <Route path=\"/about\" element={<About />} />\n                <Route path=\"*\" element={<NotFound />} />\n            </Routes>\n        </HashRouter>\n    )\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"This gives you usable routes:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"/#/         \u2192 Home\n/#/about    \u2192 About\n/#/anything \u2192 React 404 page\n"})}),"\n",(0,s.jsx)(n.h4,{id:"4-add-your-page-components",children:"4. Add Your Page Components"}),"\n",(0,s.jsxs)(n.p,{children:["Create your page components inside ",(0,s.jsx)(n.code,{children:"./src"}),":"]}),"\n",(0,s.jsxs)(n.p,{children:["Example ",(0,s.jsx)(n.code,{children:"About.tsx"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"export function About() {\n  return (\n    <div style={{ padding: '20px' }}>\n      <h1>About</h1>\n      <p>This demo shows how to upload files or directories to Swarm using Bee-JS.</p>\n    </div>\n  )\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Example ",(0,s.jsx)(n.code,{children:"Home.tsx"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"export function Home() {\n  return (\n    <div style={{ padding: '20px' }}>\n      <h1>Home</h1>\n      <p>Welcome to your Swarm-powered app.</p>\n    </div>\n  )\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Example ",(0,s.jsx)(n.code,{children:"NotFound.tsx"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"export function NotFound() {\n  return (\n    <div style={{ padding: '20px' }}>\n      <h1>Page Not Found</h1>\n      <a href=\"./#/\">Return to Home</a>\n    </div>\n  )\n}\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"5-add-a-static-404html-for-non-hash-urls",children:["5. Add a Static ",(0,s.jsx)(n.code,{children:"404.html"})," for Non-Hash URLs"]}),"\n",(0,s.jsx)(n.p,{children:"Swarm still needs a fallback for URLs like:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"/non-existent-file\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Create a ",(0,s.jsx)(n.code,{children:"./public"})," directory and save a ",(0,s.jsx)(n.code,{children:"404.html"})," file inside:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="UTF-8" />\n  <title>404 \u2013 Not Found</title>\n  <style>\n    body { font-family: sans-serif; padding: 40px; }\n    a { color: #007bff; }\n  </style>\n</head>\n\n<nav style="display: flex; gap: 12px; padding: 12px">\n  <a href="./#/">Home</a>\n  <a href="./#/about">About</a>\n</nav>\n\n<body>\n  <h1>404</h1>\n  <p>This page doesn\'t exist.</p>\n  <p><a href="./#/">Return to Home</a></p>\n</body>\n</html>\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Vite will automatically include this in ",(0,s.jsx)(n.code,{children:"dist/"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["This file handles ",(0,s.jsx)(n.strong,{children:"non-hash"})," missing paths.\nReact handles ",(0,s.jsx)(n.strong,{children:"hash"})," missing paths."]}),"\n",(0,s.jsx)(n.h4,{id:"6-build-the-project",children:"6. Build the Project"}),"\n",(0,s.jsx)(n.p,{children:"Before uploading, compile the Vite app into a static bundle:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run build\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This produces a ",(0,s.jsx)(n.code,{children:"dist/"})," folder containing:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"dist/\n  index.html\n  404.html\n  assets/\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Everything inside ",(0,s.jsx)(n.code,{children:"dist/"})," will be uploaded to your Swarm feed."]}),"\n",(0,s.jsx)(n.h4,{id:"7-deploy-site",children:"7. Deploy Site"}),"\n",(0,s.jsxs)(n.p,{children:["Now with routing handled its time to deploy the site. Refer to the ",(0,s.jsx)(n.a,{href:"/docs/develop/host-your-website#host-a-site-with-swarm-cli",children:"Host Your Website"})," guide for instructions on how to deploy your site using ",(0,s.jsx)(n.code,{children:"bee-js"})," or ",(0,s.jsx)(n.code,{children:"swarm-cli"})]}),"\n",(0,s.jsxs)(n.p,{children:["If you already have ",(0,s.jsx)(n.code,{children:"swarm-cli"})," installed, you can do this easily with the following command:"]}),"\n",(0,s.jsxs)(n.admonition,{type:"warning",children:[(0,s.jsxs)(n.p,{children:["You will need to replace ",(0,s.jsx)(n.code,{children:"<BATCH_ID>"})," with a valid batch id from your Bee node, and may need to replace the directory specified from this line..."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"swarm-cli feed upload ./dist\n"})}),(0,s.jsxs)(n.p,{children:["If you have a different build directory. If you followed all the steps above though, it should be in ",(0,s.jsx)(n.code,{children:"./dist"})," already."]})]}),"\n",(0,s.jsxs)(r.A,{children:[(0,s.jsx)(o.A,{value:"linux",label:"Linux / macOS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"swarm-cli feed upload ./dist \\\n  --identity website-publisher \\\n  --topic-string website \\\n  --stamp <BATCH_ID> \\\n  --index-document index.html \\\n  --error-document 404.html\n"})})}),(0,s.jsx)(o.A,{value:"powershell",label:"Windows PowerShell",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:"swarm-cli feed upload .\\dist `\n  --identity website-publisher `\n  --topic-string website `\n  --stamp <BATCH_ID> `\n  --index-document index.html `\n  --error-document 404.html\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:["Now the Home and About pages will be properly resolved by the routes we specified (",(0,s.jsx)(n.code,{children:"./#/"}),") and (",(0,s.jsx)(n.code,{children:"./#/about"}),"), and non existent URLs will be handled by the ",(0,s.jsx)(n.code,{children:"NotFound"})," component for hash URLs and our ",(0,s.jsx)(n.code,{children:"404.html"})," error document for all others."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:t(82046).A+"",width:"1510",height:"630"})}),"\n",(0,s.jsx)(n.h2,{id:"manifest-based-routing",children:"Manifest Based Routing"}),"\n",(0,s.jsx)(n.p,{children:"The second routing method involves directly manipulating the manifest so that routes resolve properly to the intended content."}),"\n",(0,s.jsx)(n.h3,{id:"1-upload-the-site-with-default-manifest",children:"1. Upload the Site with Default Manifest"}),"\n",(0,s.jsx)(n.p,{children:"Download example project:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/ethersphere/examples.git\ncd examples/routing-manifest\n"})}),"\n",(0,s.jsx)(n.p,{children:"Install dependencies:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Configure environment variables. There is a ",(0,s.jsx)(n.code,{children:".env"})," file with important constants listed in it. You will need to at least update it with a valid batch ID, and potentially other changes if you are not using a default setup:"]}),"\n",(0,s.jsxs)(n.p,{children:["Replace the value for ",(0,s.jsx)(n.code,{children:"BATCH_ID"})," with your own valid batch IDs. Otherwise you may also need to update ",(0,s.jsx)(n.code,{children:"BEE_URL"})," if its value doesn't match your Bee RPC endpoint."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-.env",children:"BEE_URL=http://localhost:1633\nBATCH_ID=afd0810c2ea2936df849fe7b52650e231a19b7b31dbf7f96a93f0cf8a296f3f3\nPUBLISHER_KEY=0x1111111111111111111111111111111111111111111111111111111111111111\nUPLOAD_DIR=./site\nBASE_MANIFEST=\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Start by uploading the site using the ",(0,s.jsx)(n.code,{children:"upload.js"})," script provided in the example project:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"node .\\upload.js\n"})}),"\n",(0,s.jsx)(n.p,{children:"Terminal output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"\nManifest reference: e4d93dc161d9b1fb192fdcef7e18830bd50fa5b80561de18d5f2945fb8618515\n\nURL: http://localhost:1633/bzz/e4d93dc161d9b1fb192fdcef7e18830bd50fa5b80561de18d5f2945fb8618515/\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Copy the manifest reference hash and set it inside your ",(0,s.jsx)(n.code,{children:".env"})," file as the BASE_MANIFEST value:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"BASE_MANIFEST=e4d93dc161d9b1fb192fdcef7e18830bd50fa5b80561de18d5f2945fb8618515\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If you peek inside the ",(0,s.jsx)(n.code,{children:"upload.js"})," code you will see these lines:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'const { reference } = await bee.uploadFilesFromDirectory(\n  batchId,\n  uploadDir,\n  {\n    indexDocument: "index.html",\n    errorDocument: "404.html",\n  }\n)\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Take note of the values set by the ",(0,s.jsx)(n.code,{children:"indexDocument"})," and ",(0,s.jsx)(n.code,{children:"errorDocument"})," options. With those options specified, manifest entries for the root path ",(0,s.jsx)(n.code,{children:"./"})," and non existent paths will be created on upload to resolve to ",(0,s.jsx)(n.code,{children:"index.html"})," and ",(0,s.jsx)(n.code,{children:"404.html"})," respectively. Without specifying them, your site would not load either page unless you explicitly include the entire filename with extension in the URL."]}),"\n",(0,s.jsxs)(n.p,{children:["Navigate in your browser to the manifest URL output to the terminal after running the ",(0,s.jsx)(n.code,{children:"upload.js"})," script:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"http://localhost:1633/bzz/e4d93dc161d9b1fb192fdcef7e18830bd50fa5b80561de18d5f2945fb8618515/\n"})}),"\n",(0,s.jsx)(n.p,{children:"Scroll down the example web page, read the instructions in the example website and click each of the example links to inspect how routing works by default without any manifest edits (besides those specified for the index and error documents):"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:t(17695).A+"",width:"1307",height:"951"})}),"\n",(0,s.jsxs)(n.p,{children:["You will find that links to direct files with file extensions included like ",(0,s.jsx)(n.code,{children:"/about.html"})," will work, but links to ",(0,s.jsx)(n.code,{children:"/about"})," will not. This is because we have not yet modified our manifest to set up typical routing behavior."]}),"\n",(0,s.jsx)(n.h3,{id:"2-fix-routing-with-manifest-manipulation",children:"2. Fix Routing With Manifest Manipulation"}),"\n",(0,s.jsx)(n.p,{children:"Without manifest edits, routes only work via exact file paths like:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"/index.html\n/about.html\n/contact.html\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Trying to access ",(0,s.jsx)(n.code,{children:"/about"})," or ",(0,s.jsx)(n.code,{children:"/about/"})," will fail."]}),"\n",(0,s.jsx)(n.h4,{id:"add-routing-behavior-by-manifest-manipulation",children:"Add Routing Behavior by Manifest Manipulation"}),"\n",(0,s.jsx)(n.p,{children:"We can easily add standard routing behavior by adding entries to our manifest which link the content reference with our desired URL paths:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"node.addFork('about', referenceForAbout, metadata)\nnode.addFork('about/', referenceForAbout, metadata)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["After this, both ",(0,s.jsx)(n.code,{children:"/about"})," and ",(0,s.jsx)(n.code,{children:"/about/"})," will resolve to the same content as ",(0,s.jsx)(n.code,{children:"/about.html"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Run the provided script to update the manifest:"}),"\n",(0,s.jsxs)(n.admonition,{type:"warning",children:[(0,s.jsxs)(n.p,{children:["Make sure you have already set the ",(0,s.jsx)(n.code,{children:"BASE_MANIFEST"})," to the hash returned from the upload script we ran above or else this won't work:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"BASE_MANIFEST=e4d93dc161d9b1fb192fdcef7e18830bd50fa5b80561de18d5f2945fb8618515\n"})})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"node .\\updateManifest.js\n"})}),"\n",(0,s.jsx)(n.p,{children:"Terminal output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"Updated manifest reference: 1483be29a42ec1e40b4d639f800a8fd982db9d5146088672a5edef9a1e0648aa\n\nURL: http://localhost:1633/bzz/1483be29a42ec1e40b4d639f800a8fd982db9d5146088672a5edef9a1e0648aa/007bff\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Try navigating to the ",(0,s.jsx)(n.code,{children:"/about"})," and ",(0,s.jsx)(n.code,{children:"/about/"})," routes which previously led to a 404 page, they should now resolve properly. ",(0,s.jsx)(n.code,{children:"/about.html"})," will still resolve properly as it did previously."]}),"\n",(0,s.jsx)(n.h3,{id:"3-remove-routes-and-add-new-ones",children:"3. Remove Routes and Add New Ones"}),"\n",(0,s.jsxs)(n.p,{children:["Manifests control ",(0,s.jsx)(n.strong,{children:"which paths exist"})," on your site by mapping paths to immutable Swarm content references. To remove a page from your site, remove its route(s) from the manifest:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'node.removeFork("old-page.html")\n'})}),"\n",(0,s.jsx)(n.p,{children:"If you previously added clean-URL aliases such as:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'node.addFork("about", referenceForAbout, metadata)\nnode.addFork("about/", referenceForAbout, metadata)\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u2026then you must remove ",(0,s.jsx)(n.strong,{children:"all"})," routes that expose that content:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'node.removeFork("about")\nnode.removeFork("about/")\nnode.removeFork("about.html")\n'})}),"\n",(0,s.jsxs)(n.p,{children:["You can also reuse the ",(0,s.jsx)(n.strong,{children:"same content reference"})," under a different path by adding a new manifest entry that points to that same reference:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'node.addFork("new-path", existingFileReference, metadata)\n'})}),"\n",(0,s.jsx)(n.p,{children:"This is useful when you want the same page to be available at a new URL without re-uploading or changing the underlying content. If you remove the old route, the old URL will return a 404, while the new URL will serve the same content."}),"\n",(0,s.jsx)(n.p,{children:"Run the provided script to test the behavior:"}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsxs)(n.p,{children:["Make sure that once again you have updated the ",(0,s.jsx)(n.code,{children:".env"})," file with the hash returned from the second step before running this script."]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"node .\\updateManifest.js\n"})}),"\n",(0,s.jsx)(n.p,{children:"Terminal output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"\nUpdated manifest reference: 53e90f4033b99c7f6b82026b8f7beb39f42f99fbb816ae76e850cf2a1b45491d\n\nURL: http://localhost:1633/bzz/53e90f4033b99c7f6b82026b8f7beb39f42f99fbb816ae76e850cf2a1b45491d/\n\nRoutes now:\n  /moved-about\n  /moved-about/\nRemoved:\n  /about\n  /about/\n  /about.html\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Now all our old links to the ",(0,s.jsx)(n.code,{children:"about"})," page will 404. However, you can still reach the same content by navigating to the newly added routs:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"/moved-about\n/moved-about/\n"})}),"\n",(0,s.jsx)(n.p,{children:"Manually add them to the end of your website URL to check that they load properly."}),"\n",(0,s.jsx)(n.h3,{id:"4-manifest-routing-enables-dynamic-content",children:"4. Manifest Routing Enables Dynamic Content"}),"\n",(0,s.jsx)(n.p,{children:"Once you understand manifest-based routing, you can dynamically:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Add new paths (e.g. blog posts, product pages)"}),"\n",(0,s.jsx)(n.li,{children:"Create custom routes"}),"\n",(0,s.jsx)(n.li,{children:"Remove unwanted paths"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},82046(e,n,t){t.d(n,{A:()=>a});const a=t.p+"assets/images/hash-routing-9ded011466d98e803d9f75f3b1c0116c.jpg"}}]);