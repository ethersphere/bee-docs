"use strict";(self.webpackChunkbee_docs=self.webpackChunkbee_docs||[]).push([[626],{28453(e,n,o){o.d(n,{R:()=>a,x:()=>r});var t=o(96540);const i={},s=t.createContext(i);function a(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(s.Provider,{value:n},e.children)}},62625(e,n,o){o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"develop/tools-and-features/pinning","title":"Pinning","description":"Each Bee node is configured to reserve a certain amount of memory on your computer\'s hard drive to store and serve chunks within their neighborhood of responsibility for other nodes in the Swarm network. Once this alloted space has been filled, each Bee node deletes older chunks to make way for newer ones as they are uploaded by the network.","source":"@site/docs/develop/tools-and-features/pinning.md","sourceDirName":"develop/tools-and-features","slug":"/develop/tools-and-features/pinning","permalink":"/docs/develop/tools-and-features/pinning","draft":false,"unlisted":false,"editUrl":"https://github.com/ethersphere/docs.github.io/blob/master/docs/develop/tools-and-features/pinning.md","tags":[],"version":"current","frontMatter":{"title":"Pinning","id":"pinning"},"sidebar":"develop","previous":{"title":"GSOC","permalink":"/docs/develop/tools-and-features/gsoc"},"next":{"title":"Erasure Coding","permalink":"/docs/develop/tools-and-features/erasure-coding"}}');var i=o(74848),s=o(28453);const a={title:"Pinning",id:"pinning"},r=void 0,c={},d=[{value:"Pin During Upload",id:"pin-during-upload",level:2},{value:"Administer Pinned Content",id:"administer-pinned-content",level:2},{value:"Unpinning Content",id:"unpinning-content",level:3},{value:"Pinning Already Uploaded Content",id:"pinning-already-uploaded-content",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Each Bee node is configured to reserve a certain amount of memory on your computer's hard drive to store and serve chunks within their ",(0,i.jsx)(n.em,{children:"neighborhood of responsibility"})," for other nodes in the Swarm network. Once this alloted space has been filled, each Bee node deletes older chunks to make way for newer ones as they are uploaded by the network."]}),"\n",(0,i.jsx)(n.p,{children:"Each time a chunk is accessed, it is moved back to the end of the deletion queue, so that regularly accessed content stays alive in the network and is not deleted by a node's garbage collection routine."}),"\n",(0,i.jsxs)(n.p,{children:["Bee nodes provide a facility to ",(0,i.jsx)(n.strong,{children:"pin"})," important content so that it is not deleted by the node's garbage collection routine. Chunks can be ",(0,i.jsx)(n.em,{children:"pinned"})," either during upload, or retrospectively using the Swarm reference."]}),"\n",(0,i.jsx)(n.h2,{id:"pin-during-upload",children:"Pin During Upload"}),"\n",(0,i.jsxs)(n.p,{children:["To store content so that it will persist even when Bee's garbage collection routine is deleting old chunks, we simply pass the ",(0,i.jsx)(n.code,{children:"Swarm-Pin"})," header set to ",(0,i.jsx)(n.code,{children:"true"})," when uploading."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -H "Swarm-Pin: true" -H "Swarm-Postage-Batch-Id: 78a26be9b42317fe6f0cbea3e47cbd0cf34f533db4e9c91cf92be40eb2968264"  --data-binary @bee.mp4 localhost:1633/bzz\\?bee.mp4\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "reference": "1bfe7c3ce4100ae7f02b62e38d3e8d4c3a86ea368349614a87827402f20cbb30"\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"administer-pinned-content",children:"Administer Pinned Content"}),"\n",(0,i.jsxs)(n.p,{children:["To check what content is currently pinned on your node, query the ",(0,i.jsx)(n.code,{children:"pins"})," endpoint of your Bee API:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl localhost:1633/pins\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "references": [\n    "1bfe7c3ce4100ae7f02b62e38d3e8d4c3a86ea368349614a87827402f20cbb30"\n  ]\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"or, to check for specific references:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl localhost:1633/pins/1bfe7c3ce4100ae7f02b62e38d3e8d4c3a86ea368349614a87827402f20cbb30\n"})}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.code,{children:"404"})," response indicates the content is not available."]}),"\n",(0,i.jsx)(n.h3,{id:"unpinning-content",children:"Unpinning Content"}),"\n",(0,i.jsxs)(n.p,{children:["We can unpin content by sending a ",(0,i.jsx)(n.code,{children:"DELETE"})," request to the pinning endpoint using the same reference:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -XDELETE http://localhost:1633/pins/1bfe7c3ce4100ae7f02b62e38d3e8d4c3a86ea368349614a87827402f20cbb30\n``\n\n```json\n{"message":"OK","code":200}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Now, when check again, we will get a ",(0,i.jsx)(n.code,{children:"404"})," error as the content is no longer pinned."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl localhost:1633/pins/1bfe7c3ce4100ae7f02b62e38d3e8d4c3a86ea368349614a87827402f20cbb30\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{ "message": "Not Found", "code": 404 }\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Pinning and unpinning is possible for files (as in the example) and also the chunks, directories, and bytes endpoints. See the ",(0,i.jsx)(n.a,{href:"/api/",children:"API"})," documentation for more details."]})}),"\n",(0,i.jsx)(n.h3,{id:"pinning-already-uploaded-content",children:"Pinning Already Uploaded Content"}),"\n",(0,i.jsx)(n.p,{children:"The previous example showed how we can pin content upon upload. It is also possible to pin content that is already uploaded and present in the Swarm."}),"\n",(0,i.jsxs)(n.p,{children:["To do so, we can send a ",(0,i.jsx)(n.code,{children:"POST"})," request including the swarm reference to the files pinning endpoint."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl -X POST http://localhost:1633/pins/7b344ea68c699b0eca8bb4cfb3a77eb24f5e4e8ab50d38165e0fb48368350e8f\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{ "message": "OK", "code": 200 }\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"pins"})," operation will attempt to fetch the content from the network if it is not available on the local node."]}),"\n",(0,i.jsx)(n.p,{children:"Now, if we query our files pinning endpoint again, the swarm reference will be returned."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:1633/pins/7b344ea68c699b0eca8bb4cfb3a77eb24f5e4e8ab50d38165e0fb48368350e8f\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "reference": "7b344ea68c699b0eca8bb4cfb3a77eb24f5e4e8ab50d38165e0fb48368350e8f"\n}\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"While the pin operation will attempt to fetch content from the network if it is not available locally, we advise you to ensure that the content is available locally before calling the pin operation. If the content, for whatever reason, is only fetched partially from the network, the pin operation only partly succeeds and leaves the internal administration of pinning in an inconsistent state."})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}}}]);