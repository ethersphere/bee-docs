<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<title data-react-helmet="true">Persistence | Swarm Bee Client</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Persistence | Swarm Bee Client"><meta data-react-helmet="true" name="description" content="Each Bee node is configured to reserve a certain amount of memory on your computer&#x27;s hard drive to store and serve chunks within their neighbourhood of responsibility for other nodes in the Swarm network. Once this alloted space has been filled, each Bee node delete older chunks to make way for newer ones as they are uploaded by the network."><meta data-react-helmet="true" property="og:description" content="Each Bee node is configured to reserve a certain amount of memory on your computer&#x27;s hard drive to store and serve chunks within their neighbourhood of responsibility for other nodes in the Swarm network. Once this alloted space has been filled, each Bee node delete older chunks to make way for newer ones as they are uploaded by the network."><meta data-react-helmet="true" property="og:url" content="https://bee.ethswarm.org/docs/advanced/persistence"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://bee.ethswarm.org/docs/advanced/persistence"><link rel="stylesheet" href="/styles.33a8e045.css">
<link rel="preload" href="/styles.0b785dad.js" as="script">
<link rel="preload" href="/runtime~main.3f1a3c91.js" as="script">
<link rel="preload" href="/main.4df23ca3.js" as="script">
<link rel="preload" href="/1.67adf19e.js" as="script">
<link rel="preload" href="/2.7fc3731b.js" as="script">
<link rel="preload" href="/1be78505.1d267528.js" as="script">
<link rel="preload" href="/c4f5d8e4.cdbbdeef.js" as="script">
<link rel="preload" href="/35.8686e65d.js" as="script">
<link rel="preload" href="/34.9a47932b.js" as="script">
<link rel="preload" href="/20ac7829.debe9cf7.js" as="script">
<link rel="preload" href="/17896441.6c2cb7eb.js" as="script">
<link rel="preload" href="/23e6510a.0f02ba4f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/swarm-logo-2.svg" alt="Swarm Logo"><strong class="navbar__title">Swarm Bee</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Get Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/api-reference/api-reference">API Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ethersphere/bee" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/swarm-logo-2.svg" alt="Swarm Logo"><strong class="navbar__title">Swarm Bee</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Get Started</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/api-reference/api-reference">API Reference</a></li><li class="menu__list-item"><a href="https://github.com/ethersphere/bee" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Welcome!</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Installation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation/quick-start">Quick Start</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation/configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation/manual">Manual Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation/build-from-source">Build from Source</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation/docker">Bee Using Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation/connectivity">Connectivity</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation/bee-clef">Clef External Signer</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Maintainance</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/maintenance/backups">Backups</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Basic Usage</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/working-with-your-node">Working With Your Node</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/upload-and-download">Upload and Download Files</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/upload-a-directory">Upload a Directory</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/host-your-website-using-ens">Host Your Website on Swarm</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/store-with-encryption">Store with Encryption</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Advanced Usage</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/pss">PSS Messaging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/tags">Track Upload Status</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/advanced/persistence">Persistence</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/swap">SWAP Bandwidth Accounting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/starting-a-test-network">Starting a Test Network</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-reference/api-reference">API and Debug API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Bee Developers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/bee-developers/useful-dev-info">Useful Developer Info</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Join Us</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/community/community">Community</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Persistence</h1></header><div class="markdown"><p>Each Bee node is configured to reserve a certain amount of memory on your computer&#x27;s hard drive to store and serve chunks within their <em>neighbourhood of responsibility</em> for other nodes in the Swarm network. Once this alloted space has been filled, each Bee node delete older chunks to make way for newer ones as they are uploaded by the network.</p><p>Each time a chunk is accessed, it is moved back to the end of the deletion queue, so that regularly accessed content stays alive in the network and is not deleted by a node&#x27;s garbage collection routine.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>While pinning files is a great solution for maintaining the persistence of your files in the network, Swarm will soon include storage incentives where files can be persisted simply by rewarding storer nodes with BZZ. Stay in touch for exciting developments soon!</p></div></div><p>This, however, presents a problem for content which is important, but accessed seldom requested. In order to keep this content alive, Bee nodes provide a facility to <strong>pin</strong> important content so that it is not deleted.</p><p>There are two flavours of pinning, <em>local</em> and <em>global</em>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="local-pinning"></a>Local Pinning<a aria-hidden="true" tabindex="-1" class="hash-link" href="#local-pinning" title="Direct link to heading">#</a></h2><p>If a node operator wants to keep content so that it can be accessed only by local users of that node, via the <a href="/docs/api-reference/api-reference">APIs</a> or <a href="/docs/advanced/gateway">Gateway</a>, chunks can be <em>pinned</em> either during upload, or retrospectively using the Swarm reference.</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Files pinned using local pinning will still not necessarily be available to the rest of the network. Read <a href="">global pinning</a> to find out how to keep your files available to the whole of the swarm.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="pin-during-upload"></a>Pin During Upload<a aria-hidden="true" tabindex="-1" class="hash-link" href="#pin-during-upload" title="Direct link to heading">#</a></h3><p>To store content so that it will persist even when Bee&#x27;s garbage collection routine is deleting old chunks, we simply pass the <code>Swarm-Pin</code> header set to <code>true</code> when uploading.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">curl -H &quot;swarm-pin: true&quot; --data-binary @bee.mp4 localhost:1633/files\?bee.mp4</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">&quot;reference&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;7b344ea68c699b0eca8bb4cfb3a77eb24f5e4e8ab50d38165e0fb48368350e8f&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="administrating-pinned-content"></a>Administrating Pinned Content<a aria-hidden="true" tabindex="-1" class="hash-link" href="#administrating-pinned-content" title="Direct link to heading">#</a></h3><p>Let&#x27;s check to make sure this content was indeed pinned by querying the chunks api for the swarm reference to see whether the root chunk is currently pinned.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">curl http://localhost:1633/pin/chunks/7b344ea68c699b0eca8bb4cfb3a77eb24f5e4e8ab50d38165e0fb48368350e8f</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">&quot;address&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;7b344ea68c699b0eca8bb4cfb3a77eb24f5e4e8ab50d38165e0fb48368350e8f&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">&quot;pinCounter&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><p>Success! Our pin counter is set to <code>1</code>!</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="unpinning-files"></a>Unpinning Files<a aria-hidden="true" tabindex="-1" class="hash-link" href="#unpinning-files" title="Direct link to heading">#</a></h4><p>If we later decide our content is no longer worth keeping, we can simply unpin it by sending a <code>DELETE</code> request to the files pinning endpoint using the same reference.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">curl -XDELETE http://localhost:1633/pin/files/7b344ea68c699b0eca8bb4cfb3a77eb24f5e4e8ab50d38165e0fb48368350e8f</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">``</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{&quot;message&quot;:&quot;OK&quot;,&quot;code&quot;:200}</span></div></div></div></div></div><p>Now, if we check again, we&#x27;ll get a <code>404</code> error as the content is no longer pinned.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">curl http://localhost:1633/pin/chunks/7b344ea68c699b0eca8bb4cfb3a77eb24f5e4e8ab50d38165e0fb48368350e8f</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">&quot;message&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Not Found&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">&quot;code&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">404</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="pinning-already-uploaded-content"></a>Pinning Already Uploaded Content<a aria-hidden="true" tabindex="-1" class="hash-link" href="#pinning-already-uploaded-content" title="Direct link to heading">#</a></h4><p>Content which already exists on the node can be repinned if it has not yet been garbage collected.</p><p>To pin content existing on our node, we can send a <code>POST</code> request including the swarm reference to the files pinning endpoint.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">curl -XPOST http://localhost:1633/pin/files/7b344ea68c699b0eca8bb4cfb3a77eb24f5e4e8ab50d38165e0fb48368350e8f</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">``</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{&quot;message&quot;:&quot;OK&quot;,&quot;code&quot;:200}</span></div></div></div></div></div><p>Now, if we query our files pinning endpoint again, the pin counter will once again have been incremented.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">curl http://localhost:1633/pin/chunks/7b344ea68c699b0eca8bb4cfb3a77eb24f5e4e8ab50d38165e0fb48368350e8f</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">&quot;address&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;7b344ea68c699b0eca8bb4cfb3a77eb24f5e4e8ab50d38165e0fb48368350e8f&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token property">&quot;pinCounter&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>We recommended that content is pinned during upload for reliable pinning behaviour, as there is a chance some or all of your chunks may be deleted to free up space between uploading and pinning if pinned retrospectively.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="global-pinning"></a>Global Pinning<a aria-hidden="true" tabindex="-1" class="hash-link" href="#global-pinning" title="Direct link to heading">#</a></h2><p>While <a href="">local pinning</a> ensures that your own node does not delete files you have uploaded, nodes which store your chunks because they fall within their <em>neighbourhood of responsibility</em> may have deleted content which has not been recently accessed to make way for new chunks.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-info codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">For more info on how chunks are distributed, persisted and stored within the network, read</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[The Book of Swarm](https://swarm-gateways.net/bzz:/latest.bookofswarm.eth/the-book-of-swarm.pdf).</span></div></div></div></div></div><p>To keep this content alive, your Bee node can be configured to refresh this content when it requested by other nodes in the network, using <strong>global pinning</strong>.</p><p>First, we must start up our node with the <code>global-pinning-enable</code> flag set.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">bee start\</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --verbosity 5 \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --swap-endpoint https://rpc.slock.it/goerli \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --global-pinning-enable \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --debug-api-enable</span></div></div></div></div></div><p>Next, we pin our file locally, as shown above.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">curl -H &quot;swarm-pin: true&quot; --data-binary @bee.mp4 localhost:1633/files\?bee.mp4</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">&quot;reference&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;7b344ea68c699b0eca8bb4cfb3a77eb24f5e4e8ab50d38165e0fb48368350e8f&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><p>Now, when we distribute links to our files, we must also include the first two bytes of our overlay address as the <em>target</em>. If a chunk that has already been garbage collected by it&#x27;s storer nodes is requested, the storer node will send a message using <a href="/docs/advanced/pss">PSS</a> to the Swarm neighbourhood defined by this prefix, of which our node is a member.</p><p>Let&#x27;s use the addresses API endpoint to find out our target prefix.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">curl -s http://localhost:1635/addresses | jq .overlay</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;320ed0e01e6e3d06cab44c5ef85a0898e68f925a7ba3dc80ee614064bb7f9392&quot;</span></div></div></div></div></div><p>Finally, we take the first two bytes of our overlay address, <code>320e</code> and include this when referencing our chunk.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">curl http://localhost:1633/files/7b344ea68c699b0eca8bb4cfb3a77eb24f5e4e8ab50d38165e0fb48368350e8f?targets=320e</span></div></div></div></div></div><p>Now, even if our chunks are deleted, they will be repaired in the network by our local Bee node and will always be available to the whole swarm!</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/ethersphere/docs.github.io/blob/master/docs/advanced/persistence.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/advanced/tags"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Track Upload Status</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/advanced/swap"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SWAP Bandwidth Accounting Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#local-pinning" class="table-of-contents__link">Local Pinning</a><ul><li><a href="#pin-during-upload" class="table-of-contents__link">Pin During Upload</a></li><li><a href="#administrating-pinned-content" class="table-of-contents__link">Administrating Pinned Content</a></li></ul></li><li><a href="#global-pinning" class="table-of-contents__link">Global Pinning</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Swarm</h4><ul class="footer__items"><li class="footer__item"><a href="https://ethswarm.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Swarm</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://beehive.ethswarm.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mattermost</a></li><li class="footer__item"><a href="https://www.reddit.com/r/ethswarm" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reddit</a></li><li class="footer__item"><a href="https://twitter.com/ethswarm" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://medium.com/ethereum-swarm" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/ethersphere/bee" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyleft Â© 2020.</div></div></div></footer></div>
<script src="/styles.0b785dad.js"></script>
<script src="/runtime~main.3f1a3c91.js"></script>
<script src="/main.4df23ca3.js"></script>
<script src="/1.67adf19e.js"></script>
<script src="/2.7fc3731b.js"></script>
<script src="/1be78505.1d267528.js"></script>
<script src="/c4f5d8e4.cdbbdeef.js"></script>
<script src="/35.8686e65d.js"></script>
<script src="/34.9a47932b.js"></script>
<script src="/20ac7829.debe9cf7.js"></script>
<script src="/17896441.6c2cb7eb.js"></script>
<script src="/23e6510a.0f02ba4f.js"></script>
</body>
</html>